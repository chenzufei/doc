

NTP，网络时间协议，使用 123/udp 端口进行网络时钟同步

NTP客户端：
以前Linux时间同步基本是使用 ntpdate 和 ntpd 这两个工具实现的
现在：RHEL/CentOS 7.x 已经将 chrony 作为默认时间同步工具了
      ubuntu使用 systemd-timesyncd 服务(断点式更新时间)。


NTP服务端，可以安装chrony、ntpd，或者open-ntp，推荐chrony。


1、常见时区
UTC：通用协调时(UTC, Universal Time Coordinated)
GMT：格林威治标准时间 (Greenwich Mean Time)，与UTC基本相同
CST：中国标准时间 (China Standard Time)    GMT + 8 = UTC + 8 = CST

2、timedatectl
timedatectl status                              #查看时间配置
timedatectl set-time 15:58:30                   #只设置时间
timedatectl set-time 20151120                   #只设置日期
timedatectl set-time '16:10:40 2015-11-20'      #设置时间和日期
timedatectl set-local-rtc 1                     #将RTC设置为本地时间
timedatectl set-local-rtc 0                     #将RTC设置为UTC
timedatectl set-ntp no                          #设置是否启用ntp    sudo timedatectl set-ntp on
timedatectl set-timezone America/New_York       #设置时区，比如Asia/Shanghai
timedatectl list-timezones                      #列出所有可用的时区

3、chrony
Chrony是一个开源的自由软件，centos8中默认使用chronyd来做时间服务。
chrony既可作时间服务器服务端，也可作客户端。
chrony由两个程序组成，分别是chronyd和chronyc。

yum install chrony -y

systemctl status chronyd
systemctl restart chronyd
systemctl enable chronyd          设置开机自启
systemctl is-enabled chronyd

配置
/etc/chrony.conf
server ntp.aliyun.com iburst
chronyc sources

4、其他
systemctl stop firewalld
systemctl disalbe firewalld
chrony和ntpd类似firewalld和iptables，不能共存，同时只能存在一个服务运行。

5、ubuntu 

systemd-timesyncd 客户端
在 Ubuntu 20.04 及之后的版本中，内置了timesyncd时间同步功能。

sudo apt-get install systemd-timesyncd    #安装

vi /etc/systemd/timesyncd.conf            #修改配置文件
NTP=ntp.tencent.com
FallbackNTP=ntp1.tencent.com,ntp2.tencent.com,ntp3.tencent.com

systemctl restart systemd-timesyncd       #重启systemd-timesyncd服务   


6、ubuntu也可以使用ntp做时间同步（渐进式更新时间）
apt install ntp
systemctl status ntp


vim /etc/ntp.conf
systemctl reload ntp.service
systemctl enable ntp.service

netstat -anup | grep 123




